import sys
from pathlib import Path
from colorama import init, Fore, Style

def print_dir_structure(path: Path, prefix=""):
    """
    –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –≤–∏–≤–æ–¥–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó path,
    –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—á–∏ –∫–æ–ª—å–æ—Ä–∏ –¥–æ —ñ–º–µ–Ω –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π —ñ —Ñ–∞–π–ª—ñ–≤.
    """
    if not path.exists():
        print(Fore.RED + f"–ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{path}' –Ω–µ —ñ—Å–Ω—É—î." + Style.RESET_ALL)
        return
    if not path.is_dir():
        print(Fore.RED + f"–ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{path}' –Ω–µ —î –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—î—é." + Style.RESET_ALL)
        return
    
    items = list(path.iterdir())
    count = len(items)
    
    for index, item in enumerate(sorted(items, key=lambda x: (not x.is_dir(), x.name.lower()))):
        connector = "‚îó" if index == count - 1 else "‚î£"
        if item.is_dir():
            print(f"{prefix}{connector} üìÇ{Fore.BLUE}{item.name}{Style.RESET_ALL}")
            # –§–æ—Ä–º—É—î–º–æ –Ω–æ–≤–∏–π –ø—Ä–µ—Ñ—ñ–∫—Å –¥–ª—è –≤–∫–ª–∞–¥–µ–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
            extension = "   " if index == count - 1 else "‚îÉ  "
            print_dir_structure(item, prefix + extension)
        else:
            print(f"{prefix}{connector} üìú{Fore.GREEN}{item.name}{Style.RESET_ALL}")

def main():
    # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è colorama
    init(autoreset=True)
    
    if len(sys.argv) != 2:
        print(Fore.YELLOW + "–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python hw03.py /—à–ª—è—Ö/–¥–æ/–¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó" + Style.RESET_ALL)
        sys.exit(1)
    
    directory_path = Path(sys.argv[1])
    
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ —Ç–∏–ø—É —à–ª—è—Ö—É
    if not directory_path.exists():
        print(Fore.RED + f"–ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{directory_path}' –Ω–µ —ñ—Å–Ω—É—î." + Style.RESET_ALL)
        sys.exit(1)
    if not directory_path.is_dir():
        print(Fore.RED + f"–ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{directory_path}' –Ω–µ —î –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—î—é." + Style.RESET_ALL)
        sys.exit(1)
    
    print(f"üì¶{Fore.BLUE}{directory_path.name}{Style.RESET_ALL}")
    print_dir_structure(directory_path)

if __name__ == "__main__":
    main()
